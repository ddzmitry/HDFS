<!DOCTYPE html>
<!-- saved from url=(0066)http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#/script/edit/1 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Pig</title>
    <link rel="stylesheet" href="./app(1).css">
    <script>
      ENV = {
        I18N_COMPILE_WITHOUT_HANDLEBARS: true,
        FEATURES:{
          I18N_TRANSLATE_HELPER_SPAN:false
        }
      };
    </script>
    <script src="./vendor.js(1).download"></script>
    <script src="./app.js(1).download"></script>
    <script>require('initialize');</script>
  </head>
  <body class="ember-application" style="cursor: auto;">

<div id="ember478" class="ember-view">

<div class="wrap">
	<div id="ember578" class="ember-view">

<div class="container-fluid">
  <div class="row">
    <div class="col-md-3 navigation">
      <div class="well">

        <div id="ember609" class="ember-view list-group nav-main"><a id="ember618" class="ember-view list-group-item pig-nav-item text-left"><i class="fa fa-fw fa-2x fa-file-code-o"></i> <span>Scripts</span></a><a id="ember619" class="ember-view list-group-item pig-nav-item text-left"><i class="fa fa-fw fa-2x fa-plug"></i> <span>UDFs</span></a><a id="ember620" class="ember-view list-group-item pig-nav-item text-left"><i class="fa fa-fw fa-2x fa-clock-o"></i> <span>History</span></a></div>
        <div class="nav-script-wrap in">
          <div class=" nav-script">
            <div>
              <button type="button" class="close_script" tabindex="-1" data-ember-action="621" data-original-title="" title="">
                <i class="fa fa-times"></i>
              </button>
            </div>
            <div class="script-title">
              
                <span>Oldest_good_movies</span>
                
            </div>
           <ul class="script-actions list-unstyled">
              <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" tabindex="-1" data-ember-action="622" class="btn btn-block disabled" data-bindattr-623="623"><i class="fa fa-fw fa-save"></i> Save</a></li>
              <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" tabindex="-1" data-ember-action="632" class="btn btn-block" data-bindattr-633="633"><i class="fa fa-fw fa-copy"></i> Copy</a></li>
              <li class="divider"></li>
              <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" tabindex="-1" data-ember-action="635" class="btn btn-block" data-bindattr-636="636"><i class="fa fa-fw fa-trash-o"></i> Delete</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div id="ember585" class="ember-view">

<div id="alert-wrap">
 <div id="ember647" class="ember-view"></div>
</div>
</div>
    </div>
    <div class="col-md-9 main-content">
      

<ul class="nav nav-tabs nav-tabs-script" role="tablist">
  
    <li id="ember10385" class="ember-view active">
      <a id="ember10387" class="ember-view active" href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#/script/edit/1">Script</a>
    </li>
  
    <li id="ember10392" class="ember-view">
      <a id="ember10394" class="ember-view" href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#/script/history/1">History</a>
    </li>
  
</ul>

<div id="ember10377" class="ember-view">

<div class="edit-script">
  <div class="panel panel-editscript panel-default" data-bindattr-10399="10399">
    <div class="panel-heading">
      

      
      
        <div class="btn-group pull-right" data-bindattr-10417="10417">
          <button data-ember-action="10418" type="button" class="btn btn-primary">Execute</button>

          <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
            <span class="sr-only">Toggle Dropdown</span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10420">Explain</a></li>
            <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10422">Syntax check</a></li>
          </ul>
        </div>
        <div class="btn-group btn-group-xs pull-right tez-exec">
          <label class="btn btn-default" data-ember-action="10424">
            <i class="fa fa-square-o" data-bindattr-10425="10425"></i> Execute on Tez
          </label>
        </div>
        

      
      
        <div class="script-title">
          <h4> Oldest_good_movies <a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10429" class="btn-rename"><i class="fa fa-pencil"></i></a></h4>
        </div>
      

    </div>
    <div class="panel-body">
      <div class="pull-left">
      <div id="ember10400" class="ember-view btn-group">

<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
  PIG helper
  <span class="caret"></span>
</button>
<ul class="dropdown-menu" id="pig_helper">
  
    <li class="dropdown-submenu">
      <a>Eval Functions</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10444">AVG(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10446">CONCAT(%VAR1%, %VAR2%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10448">COUNT(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10450">COUNT_START(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10452">IsEmpty(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10454">DIFF(%VAR1%, %VAR2%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10456">MAX(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10458">MIN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10460">SIZE(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10462">SUM(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10464">TOKENIZE(%VAR%, %DELIM%)</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Relational Operators</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10473">COGROUP %VAR1% BY %VAR2%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10475">CROSS %VAR1%, %VAR2%;</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10477">DISTINCT %VAR%;</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10479">FILTER %VAR% BY %COND%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10481">FLATTEN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10483">FOREACH %DATA% GENERATE %NEW_DATA%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10485">FOREACH %DATA% {%NESTED_BLOCK%}</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10487">GROUP %VAR1% BY %VAR2%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10489">GROUP %VAR% ALL</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10491">JOIN %VAR% BY </a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10493">LIMIT %VAR% %N%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10495">ORDER %VAR% BY %FIELD%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10497">SAMPLE %VAR% %SIZE%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10499">SPLIT %VAR1% INTO %VAR2% IF %EXPRESSIONS%</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10501">UNION %VAR1%, %VAR2%</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>I/0</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10510">LOAD '%FILE%';</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10512">DUMP %VAR%;</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10514">STORE %VAR% INTO %PATH%;</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Debug</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10523">EXPLAIN %VAR%;</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10525">ILLUSTRATE %VAR%;</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10527">DESCRIBE %VAR%;</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>HCatalog</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10536">LOAD '%TABLE%' USING org.apache.hive.hcatalog.pig.HCatLoader();</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Math</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10545">ABS(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10547">ACOS(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10549">ASIN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10551">ATAN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10553">CBRT(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10555">CEIL(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10557">COS(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10559">COSH(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10561">EXP(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10563">FLOOR(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10565">LOG(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10567">LOG10(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10569">RANDOM(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10571">ROUND(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10573">SIN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10575">SINH(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10577">SQRT(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10579">TAN(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10581">TANH(%VAR%)</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Tuple, Bag, Map Functions</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10590">TOTUPLE(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10592">TOBAG(%VAR%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10594">TOMAP(%KEY%, %VALUE%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10596">TOP(%topN%, %COLUMN%, %RELATION%)</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>String Functions</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10605">INDEXOF(%STRING%, '%CHARACTER%', %STARTINDEX%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10607">LAST_INDEX_OF(%STRING%, '%CHARACTER%', %STARTINDEX%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10609">LOWER(%STRING%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10611">REGEX_EXTRACT(%STRING%, %REGEX%, %INDEX%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10613">REGEX_EXTRACT_ALL(%STRING%, %REGEX%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10615">REPLACE(%STRING%, '%oldChar%', '%newChar%')</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10617">STRSPLIT(%STRING%, %REGEX%, %LIMIT%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10619">SUBSTRING(%STRING%, %STARTINDEX%, %STOPINDEX%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10621">TRIM(%STRING%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10623">UCFIRST(%STRING%)</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10625">UPPER(%STRING%)</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Macros</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10634">IMPORT '%PATH_TO_MACRO%';</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>HBase</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10643">LOAD 'hbase://%TABLE%' USING org.apache.pig.backend.hadoop.hbase.HBaseStorage('%columnList%')</a></li>
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10645">STORE %VAR% INTO 'hbase://%TABLE%' USING org.apache.pig.backend.hadoop.hbase.HBaseStorage('%columnList%')</a></li>
        
      </ul>
    </li>
  
    <li class="dropdown-submenu">
      <a>Python UDF</a>
      <ul class="dropdown-menu">
        
          <li><a href="http://localhost:8080/views/PIG/1.0.0/PIG_INSTANCE/#" data-ember-action="10654">REGISTER 'python_udf.py' USING jython AS myfuncs;</a></li>
        
      </ul>
    </li>
  
</ul>
</div>
        <div class="btn-group">
          <button type="button" data-toggle="dropdown" class="btn btn-default btn-xs dropdown-toggle disabled" data-bindattr-10401="10401">
            UDF helper
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
          
          </ul>
        </div>
      </div>
      <div class="fullscreen-toggle pull-right" data-ember-action="10405" data-toggle="tooltip" data-placement="bottom" title="" style="right: 3px;" data-original-title="Toggle fullscreen (F11)"><i class="fa fa-lg fa-expand" data-bindattr-10406="10406"></i></div>
      <kbd class="file-path pull-right" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Path of this script file on HDFS">
        
          /tmp/.pigscripts/oldestgoodmovies-2018-06-03_04-36.pig
        
      </kbd>
    </div>
    <div class="editor-container ui-resizable">
      <textarea id="pig_script" class="ember-view" style="display: none;"></textarea><div class="CodeMirror cm-s-default CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 204px; left: 34px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style=""><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 408px; min-width: 830px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>20</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 4px; top: 200px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">ratings</span> <span class="cm-operator">=</span> <span class="cm-keyword">LOAD</span> <span class="cm-error">'/ml-100k/u.data'</span> <span class="cm-keyword">AS</span> (<span class="cm-variable">userID</span><span class="cm-operator">:</span><span class="cm-variable-3">int</span>, <span class="cm-variable">movieID</span><span class="cm-operator">:</span><span class="cm-variable-3">int</span>, <span class="cm-variable">rating</span><span class="cm-operator">:</span><span class="cm-variable-3">int</span>, <span class="cm-variable">ratingTime</span><span class="cm-operator">:</span><span class="cm-variable-3">int</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">metadata</span> <span class="cm-operator">=</span> <span class="cm-keyword">LOAD</span> <span class="cm-error">'/ml-100k/u.item'</span> <span class="cm-keyword">USING</span> <span class="cm-variable-2">PigStorage</span>(<span class="cm-error">'|'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">AS</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">movieID</span><span class="cm-operator">:</span><span class="cm-variable-3">int</span>, <span class="cm-variable">movieTitle</span><span class="cm-operator">:</span><span class="cm-variable-3">chararray</span>, <span class="cm-variable">releaseDate</span><span class="cm-operator">:</span><span class="cm-variable-3">chararray</span>, <span class="cm-variable">videoRelease</span><span class="cm-operator">:</span><span class="cm-variable-3">chararray</span>, <span class="cm-variable">imdbLink</span><span class="cm-operator">:</span><span class="cm-variable-3">chararray</span>);</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">nameLookup</span> <span class="cm-operator">=</span> <span class="cm-keyword">FOREACH</span> <span class="cm-variable">metadata</span> <span class="cm-keyword">GENERATE</span> <span class="cm-variable">movieID</span>, <span class="cm-variable">movieTitle</span>, <span class="cm-variable">ToUnixTime</span>(<span class="cm-variable">ToDate</span>(<span class="cm-variable">releaseDate</span>,<span class="cm-error">'dd-MMM-yyyy'</span>)) </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">AS</span> <span class="cm-variable">releaseTime</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">raitingsByMovie</span> <span class="cm-operator">=</span> <span class="cm-keyword">GROUP</span> <span class="cm-variable">ratings</span> <span class="cm-keyword">BY</span> <span class="cm-variable">movieID</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">avgRatings</span> <span class="cm-operator">=</span> <span class="cm-keyword">FOREACH</span> <span class="cm-variable">raitingsByMovie</span> <span class="cm-keyword">GENERATE</span> <span class="cm-keyword">group</span> <span class="cm-keyword">AS</span> <span class="cm-variable">movieID</span>, <span class="cm-variable-2">AVG</span>(<span class="cm-variable">ratings</span>.<span class="cm-variable">rating</span>) <span class="cm-keyword">AS</span> <span class="cm-variable">avgRating</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">fiveStarMovies</span> <span class="cm-operator">=</span> <span class="cm-keyword">FILTER</span> <span class="cm-variable">avgRatings</span> <span class="cm-keyword">BY</span> <span class="cm-variable">avgRating</span> <span class="cm-operator">&gt;</span> <span class="cm-number">4.0</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">fiveStarWithData</span> <span class="cm-operator">=</span> <span class="cm-keyword">JOIN</span> <span class="cm-variable">fiveStarMovies</span> <span class="cm-keyword">BY</span> <span class="cm-variable">movieID</span>, <span class="cm-variable">nameLookup</span> <span class="cm-keyword">BY</span> <span class="cm-variable">movieID</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">OldfiveStarMovies</span> <span class="cm-operator">=</span> <span class="cm-keyword">ORDER</span> <span class="cm-variable">fiveStarWithData</span> <span class="cm-keyword">BY</span> <span class="cm-variable">nameLookup</span><span class="cm-operator">::</span><span class="cm-variable">releaseTime</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">DUMP</span> <span class="cm-variable">OldfiveStarMovies</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 408px;"></div><div class="CodeMirror-gutters" style="height: 421px; width: 29px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div>
      <div class="ui-resizable-handle ui-resizable-s" id="sgrip"><i class="fa fa-ellipsis-h"></i></div>
    </div>
  </div>


  <div class="params-block hidden" data-bindattr-10407="10407">
    <div class="block-title">
      <h4>Params</h4>
    </div>
    <div class="form-inline pigParams">
    
    </div>
  </div>

  <div class="arguments-block">
    <div class="block-title">
      <h4>Arguments</h4>
    </div>
    <div class="row">
      <div class="col-md-8 ">
        
          <div class="alert alert-info" role="alert">
            This pig script has no arguments defined.
          </div>
        
      </div>
      <div class="col-md-4 ">
        <div class="input-group">
          <input id="ember10412" class="ember-view ember-text-field form-control" type="text" placeholder="Pig argument">
          <span class="input-group-btn">
            <button class="btn btn-default pull-right" data-ember-action="10413"><i class="fa fa-plus"></i> Add</button>
          </span>
        </div>
      </div>

    </div>
  </div>

  

</div>
</div>

    </div>
  </div>
</div>


</div>
</div>
</div></body></html>